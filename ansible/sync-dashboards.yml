---
- name: Sync Grafana Dashboards to GlusterFS
  hosts: proxmox_vms[0]
  become: true
  tasks:
    - name: Ensure dashboard directory exists on GlusterFS
      file:
        path: /mnt/gfs_data/monitoring/dashboards
        state: directory
        mode: '0755'
        owner: 472
        group: 472

    - name: Ensure grafana data directory exists on GlusterFS
      file:
        path: /mnt/gfs_data/monitoring/grafana-data
        state: directory
        mode: '0755'
        owner: 472
        group: 472

    - name: Copy dashboard JSONs
      copy:
        src: "{{ playbook_dir }}/../docker/monitoring/dashboards/"
        dest: /mnt/gfs_data/monitoring/dashboards/
        owner: 472
        group: 472
        mode: '0644'
